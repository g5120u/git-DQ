# Git-DQ 使用說明

## 🎯 正確使用方式

Git-DQ 是一個**獨立的 Electron 應用程式**，不是要「放到其他專案底下」，而是：

### 方式一：固定安裝位置（推薦）

1. **安裝 Git-DQ 到固定位置**
   ```
   C:\tools\git-dq\  （或任何你喜歡的位置）
   ```

2. **在任何專案資料夾中使用**
   - 方法 A：在專案資料夾中建立快捷方式，指向 `C:\tools\git-dq\start.bat`
   - 方法 B：使用命令列：
     ```bash
     cd C:\tools\git-dq
     npm start -- --target "D:\你的專案資料夾"
     ```

### 方式二：複製到專案資料夾（簡單但佔空間）

1. **將整個 Git-DQ 資料夾複製到你的專案資料夾**
   ```
   D:\你的專案\
   ├── src/
   ├── package.json
   └── git-dq/          ← 複製整個 Git-DQ 到這裡
       ├── start.bat
       ├── main.js
       └── ...
   ```

2. **在專案資料夾中執行**
   ```bash
   cd D:\你的專案\git-dq
   start.bat
   ```

   **重要**：當你複製 git-dq 資料夾到其他專案時，應用程式會自動向上查找 Git 倉庫。例如：
   - 如果你的專案在 `D:\你的專案\`，Git 倉庫在 `D:\你的專案\.git`
   - 即使 git-dq 在 `D:\你的專案\git-dq\` 子資料夾中
   - 應用程式會自動找到父目錄的 Git 倉庫並顯示正確的狀態

### 方式三：使用快捷啟動腳本（最方便）

1. **將 `git-dq-here.bat` 放到任何專案資料夾**
2. **雙擊執行**，它會自動：
   - 檢查當前資料夾是否有 Git-DQ
   - 如果沒有，會尋找上層目錄的 Git-DQ（最多向上 5 層）
   - 自動設定掃描當前資料夾
   - **自動向上查找 Git 倉庫**（如果當前資料夾沒有 .git）

## ⚠️ 重要說明

### 關於 Git 配置

- **本地配置優先**：Git-DQ 只讀取和設定**當前倉庫的本地 Git 配置**（`git config --local`）
- **不會影響全局配置**：不會讀取或修改你的全局 Git 配置（`git config --global`）
- **乾淨啟動**：每次啟動時都會重新掃描，不會顯示上一個人的 Git 資料
- **複製專案時**：當你從 GitHub 下載或複製專案時，Git-DQ 會顯示該專案的 Git 狀態，不會帶有你的個人配置

### 關於多層目錄結構

當你將 git-dq 資料夾複製到專案中時：

```
D:\你的專案\
├── .git/              ← Git 倉庫在這裡
├── src/
├── package.json
└── git-dq/            ← Git-DQ 在這裡
    ├── start.bat
    └── ...
```

**應用程式會自動**：
1. 檢查 `D:\你的專案\git-dq\` 是否有 `.git`
2. 如果沒有，向上查找 `D:\你的專案\.git`
3. 找到後自動使用該 Git 倉庫的狀態

## ❌ 常見錯誤

### 錯誤 1：只複製 start.bat
❌ **錯誤做法**：只把 `start.bat` 複製到其他專案資料夾
- 這樣會找不到 `main.js`、`dq-engine.js` 等檔案
- 如果其他專案有 `package.json`，可能會啟動錯誤的專案

### 錯誤 2：誤以為要啟動端口
❌ **誤解**：以為 Git-DQ 需要啟動網頁伺服器
- Git-DQ **不使用任何端口**
- 它直接載入本地 HTML 檔案（`file://` 協議）
- 完全單機運行

### 錯誤 3：擔心會帶有別人的 Git 資料
✅ **正確理解**：
- Git-DQ 每次啟動時都會重新掃描目標資料夾
- 只讀取該資料夾的本地 Git 配置
- 不會讀取全局配置
- 從 GitHub 下載的專案會顯示該專案的 Git 狀態，不會帶有你的個人資料

## ✅ 正確理解

- **Git-DQ 是一個工具**，類似於 VS Code、Git GUI 等
- **它掃描你指定的資料夾**的 Git 狀態
- **不需要架設伺服器**，完全單機運行
- **可以放在任何位置**，然後指向任何專案資料夾
- **自動查找 Git 倉庫**：支援多層目錄結構，會自動向上查找 `.git` 目錄

## 🔧 技術說明

當你執行 `npm start -- --target "D:\專案資料夾"` 時：
1. Electron 啟動
2. `main.js` 讀取 `--target` 參數
3. 設定 `dq-engine.js` 的目標工作目錄
4. `scanWorld()` 函數會：
   - 先檢查當前目錄是否有 `.git`
   - 如果沒有，向上查找父目錄的 `.git`
   - 找到後使用該 Git 倉庫的狀態
5. 所有 Git 操作都在找到的 Git 倉庫目錄中執行

## 📝 範例

### 範例 1：固定安裝位置

假設你的專案結構：
```
D:\projects\
├── project-a\
│   ├── .git\
│   ├── src\
│   └── package.json
└── project-b\
    ├── .git\
    ├── src\
    └── package.json
```

**推薦做法**：
```
C:\tools\git-dq\          ← Git-DQ 安裝在這裡
D:\projects\project-a\     ← 你的專案
D:\projects\project-b\     ← 另一個專案
```

在 `project-a` 中管理 Git：
```bash
cd C:\tools\git-dq
npm start -- --target "D:\projects\project-a"
```

### 範例 2：複製到專案資料夾

```
D:\projects\project-a\
├── .git\                 ← Git 倉庫在這裡
├── src\
├── package.json
└── git-dq\               ← Git-DQ 複製到這裡
    ├── start.bat
    ├── main.js
    └── ...
```

**執行方式**：
```bash
cd D:\projects\project-a\git-dq
start.bat
```

**應用程式會自動**：
- 檢查 `D:\projects\project-a\git-dq\.git`（不存在）
- 向上查找 `D:\projects\project-a\.git`（找到！）
- 使用 `D:\projects\project-a` 作為 Git 倉庫根目錄
- 顯示該專案的 Git 狀態

### 範例 3：更深層的目錄結構

```
D:\projects\project-a\
├── .git\
├── src\
├── frontend\
│   └── git-dq\          ← Git-DQ 在這裡
│       ├── start.bat
│       └── ...
└── backend\
```

**執行方式**：
```bash
cd D:\projects\project-a\frontend\git-dq
start.bat
```

**應用程式會自動**：
- 檢查 `D:\projects\project-a\frontend\git-dq\.git`（不存在）
- 向上查找 `D:\projects\project-a\frontend\.git`（不存在）
- 繼續向上查找 `D:\projects\project-a\.git`（找到！）
- 使用 `D:\projects\project-a` 作為 Git 倉庫根目錄

## 🎮 遊戲功能說明

### 當前已實現的功能

1. **世界建立（git init）**
   - 如果資料夾沒有 Git 倉庫，會顯示 RPG 風格的對話框
   - 詢問是否要建立新的村莊（Git 倉庫）
   - 點擊「確定建立」執行 `git init`

2. **冒險者身分設定**
   - 設定 Git 使用者名稱和電子郵件
   - 只設定當前倉庫的本地配置，不影響全局配置

3. **冒險之書（存檔畫面）**
   - 顯示所有分支作為「數據 1/2/3」存檔槽位
   - 顯示分支的等級（LV = 提交數量）和任務（最後提交訊息）
   - 可以點擊切換到其他分支
   - 可以建立新分支

4. **冒險紀錄（提交歷史）**
   - 顯示最近的提交記錄
   - 可以點擊切換到過去的提交

5. **村莊狀態**
   - 顯示當前分支、提交數量、最後提交等資訊
   - 顯示未追蹤、已修改、已刪除的檔案

### 開發中的功能

- ⚠️ **戰鬥畫面**：用於處理提交和衝突解決（開發中）
- ⚠️ **神殿畫面**：用於 GitHub 推送（開發中）

## 🔍 故障排除

### 問題：啟動時出現亂碼
**解決方法**：
- 確保腳本開頭有 `chcp 65001`
- 檢查命令提示字元的字型設定（建議使用「新細明體」或「Consolas」）

### 問題：找不到 Git 倉庫
**解決方法**：
- 確認目標資料夾或其父目錄有 `.git` 資料夾
- 應用程式會自動向上查找，最多查找到磁碟根目錄

### 問題：顯示上一個人的 Git 資料
**解決方法**：
- 這不應該發生，因為每次啟動都會重新掃描
- 如果發生，請重新啟動應用程式
- 確認目標資料夾正確

---

**記住：Git-DQ 是 Git 工具，不是專案的一部分！** 🛠️

**讓 Git 學習變成一場冒險！** ⚔️🛡️✨
